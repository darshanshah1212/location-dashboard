{% extends 'base.html' %}
{% block content %}


<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<div class="container mt-4">

  <h1 class="mb-4">Dynamic Location Dropdowns</h1>

  <!-- Country Dropdown -->
  <div class="row g-3 mb-3" style="max-width: 600px;">
    <div class="col-md-4">
      <select id="country" class="form-select">
        <option value="">Select Country</option>
        {% for c in countries %}
          <option value="{{c.id}}">{{c.name}}</option>
        {% endfor %}
      </select>
    </div>

    <!-- State Dropdown -->
    <div class="col-md-4">
      <select id="state" class="form-select">
        <option value="">Select State</option>
      </select>
    </div>

    <!-- City Dropdown -->
    <div class="col-md-4">
      <select id="city" class="form-select">
        <option value="">Select City</option>
      </select>
    </div>
  </div>

  <!-- Message -->
  <p id="message" class="fw-bold text-success"></p>

</div>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
$(document).ready(function(){
    // Load States when country changes

    $("#country").change(function(){
        let country_id = $(this).val();
        $("#state").html('<option value="" >Select State</option>');
        $("#city").html('<option value="" >Select City</option>');

        if(country_id){
            $.ajax({
                url : '/get-all-states/' + country_id + '/',
                type : 'GET',
                success : function(data){
                    data.states.forEach(function(s){
                        $("#state").append(`<option value="${s.id}">${s.name}</option>`);
                    });
                }
            });
        }
    });

    // Load Cities when state changes

    $("#state").change(function(){
        let state_id = $(this).val();
        $("#city").html('<option value="">Select City</option>');
        
        if(state_id){
            $.ajax({
                url : '/get-all-city/' + state_id + '/',
                type : 'GET',
                success :function(data){
                    data.city.forEach(function(c){
                        $("#city").append(`<option value="${c.id}">${c.name}</option>`);
                    });
                }
            });
        }
    });
});

</script>

{% endblock %}
